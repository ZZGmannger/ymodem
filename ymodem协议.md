### SOH帧格式

| 帧头(SOH) | 帧序号 | 反帧序号 | payload | CRC16 |
| :-------: | :----: | -------- | ------- | ----- |
|     1     |   1    | 1        | 128     | 2     |

### STX帧格式

| 帧头(STX) | 帧序号 | 反帧序号 | payload | CRC16 |
| :-------: | :----: | -------- | ------- | ----- |
|     1     |   1    | 1        | 1024    | 2     |

### 

### 起始帧

使用SOH 

帧序号 00 FF

payload组成：

| filename | 0x00 | filesize                       | 0x00 | 0x00 |
| -------- | ---- | ------------------------------ | ---- | ---- |
| 字符串   |      | 字符串（16进制使用字符串描述） |      |      |

### 数据帧

正常以1024字节payload传输

最后剩余数据的处理：

剩余128—1024字节: 以STX传输，使用0x1A填充

剩余<=128  使用SOH传输 ， 使用0x1A填充



### 结束帧

采用SOH传输

帧序 00 FF

全部以00填充

### 通讯流程

 发送端                                                   接收端

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  C

SOH 00 FF "foo.c" "1064'' NUL[118] CRC CRC >>>>>>>>>>>>>

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<   ACK

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<   C

STX 01 FE data[1024] CRC CRC>>>>>>>>>>>>>>>>>>>>>>>>    

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  ACK

STX 02 FD data[1024] CRC CRC>>>>>>>>>>>>>>>>>>>>>>>

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  ACK

STX 03 FC data[1024] CRC CRC>>>>>>>>>>>>>>>>>>>>>>>

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  ACK

STX 04 FB data[1024] CRC CRC>>>>>>>>>>>>>>>>>>>>>>>

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  ACK

SOH 05 FA data[100] 1A[28] CRC CRC>>>>>>>>>>>>>>>>>>

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  ACK

EOT >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  NAK

EOT>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  ACK

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  C

SOH 00 FF NUL[128] CRC CRC >>>>>>>>>>>>>>>>>>>>>>>

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  ACK

```
#define SOH                     ((uint8_t)0x01)  /* start of 128-byte data packet */
#define STX                     ((uint8_t)0x02)  /* start of 1024-byte data packet */
#define EOT                     ((uint8_t)0x04)  /* end of transmission */
#define ACK                     ((uint8_t)0x06)  /* acknowledge */
#define NAK                     ((uint8_t)0x15)  /* negative acknowledge */
#define CA                      ((uint32_t)0x18) /* two of these in succession aborts 
```

